"""Vulnerability Scanner Module

Scans for weak, common, or reused credentials against known lists and patterns.
"""
import os
from typing import Dict, List

class VulnerabilityScanner:
    """Detects password vulnerabilities against common weak password lists."""
    def __init__(self, common_passwords_path: str = "data/common_passwords.txt"):
        self.common_passwords_path = common_passwords_path
        self.common_passwords = self._load_common_passwords()

    def _load_common_passwords(self) -> List[str]:
        if not os.path.exists(self.common_passwords_path):
            return []
        with open(self.common_passwords_path, 'r', encoding='utf-8') as file:
            return [line.strip() for line in file if line.strip()]

    def scan(self, password: str) -> Dict:
        is_common = password.lower() in self.common_passwords
        return {
            "is_common": is_common,
            "recommendation": "Change your password!" if is_common else "Good choice. Not found in common weak passwords.",
            "checked_against": len(self.common_passwords)
        }
